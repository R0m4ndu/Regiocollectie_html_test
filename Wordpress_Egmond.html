<!DOCTYPE html>
<html lang="nl">
  <head>
    <meta charset="UTF-8">
    <title>Regiocollectie - Regionaal Archief Alkmaar</title>

    <!-- Allow framing from any origin (helps with X-Frame-Options) -->
    <meta http-equiv="X-Frame-Options" content="ALLOWALL">
    <meta http-equiv="Content-Security-Policy" content="frame-ancestors *;">

    <!-- Load external CSS -->
    <link rel="stylesheet" href="https://webservices.memorix.nl/mediabank/2.0/dist/css/vendors.css">
    <link rel="stylesheet" href="https://webservices.memorix.nl/mediabank/2.0/dist/css/mediabank.css">
  </head>
<body>

  <pic-mediabank
    id="mediabank"
    data-api-key="b4c5439c-d0b1-4058-8179-62bdae733a0e"
    data-api-url="https://webservices.memorix.nl/mediabank"
  ></pic-mediabank>

  <!-- Load scripts with defer to avoid timing issues -->
  <script defer src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script defer src="https://images.memorix.nl/topviewer/1.0/src/topviewer.compressed.js"></script>
  <script defer src="https://webservices.memorix.nl/mediabank/2.0/dist/js/mediabank-deps.min.js"></script>
  <script defer src="https://webservices.memorix.nl/mediabank/2.0/dist/js/mediabank-partials.min.js"></script>
  <script defer src="https://webservices.memorix.nl/mediabank/2.0/dist/js/mediabank.min.js"></script>

  <script>
    // Wait for full window load (better for iframes than document.ready)
    window.onload = function() {
      // Small delay to ensure Angular libs are ready
      setTimeout(function() {
        if (typeof angular !== 'undefined') {
          angular.element(document).ready(function() {
            if (angular.module('Mediabank.Boot')) {
              angular.module('Mediabank.Boot')
                .run(function(gettextCatalog, MediabankConfig) {
                  MediabankConfig.whenInitialized().then(function() {
                    gettextCatalog.setCurrentLanguage('nl');
                    var galleryModes = [
                      {id: 'horizontal'},
                      {id: 'vertical'},
                      {id: 'gallery'},
                      {id: 'list'}
                    ];

                    MediabankConfig
                      .setOption('gallery.modes', galleryModes)
                      .setOption('gallery.default', 'horizontal')
                      .setOption('gallery.pagination.endless', true)
                      .setOption('gallery.pagination.bottom', false)
                      .setOption('gallery.pagination.topTemplate',
                                 'pagination/views/directives/pagination-count.html');
                  });
                });

              angular.bootstrap(document, ['Mediabank.Boot']);
            } else {
              console.error('Angular or Mediabank.Boot module not loaded');
            }
          });
        } else {
          console.error('Angular not loaded');
        }
      }, 1000); // 1-second buffer for script loading
    };
  </script>
</body>
</html>
